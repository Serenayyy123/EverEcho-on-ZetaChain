# Stage 4.9 Universal App è·¨é“¾å¥–åŠ±ç³»ç»Ÿ - éƒ¨ç½²æŒ‡å—

## ğŸ¯ å¿«é€Ÿå¼€å§‹ (æ¨è)

### ä¸€é”®å¯åŠ¨
```bash
# Windows PowerShell
./start-stage4.9-simple.ps1

# æˆ–è€…ä½¿ç”¨ npm
npm run stage4.9:start
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. å®‰è£…ä¾èµ–
2. éƒ¨ç½²åˆçº¦
3. å¯åŠ¨åç«¯å’Œå‰ç«¯
4. æ‰“å¼€æµè§ˆå™¨

## ğŸ”§ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£…ä¾èµ–
npm install

# æ£€æŸ¥ Node.js ç‰ˆæœ¬ (éœ€è¦ >= 18)
node --version
```

### 2. å¯åŠ¨æœ¬åœ°åŒºå—é“¾
```bash
# å¯åŠ¨ Hardhat èŠ‚ç‚¹
npx hardhat node
```

### 3. éƒ¨ç½²åˆçº¦
```bash
# å¿«é€Ÿéƒ¨ç½²
npm run stage4.9:quick

# æˆ–å®Œæ•´éƒ¨ç½²
npm run stage4.9:deploy
```

### 4. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨åç«¯ (æ–°ç»ˆç«¯)
npm run dev:backend

# å¯åŠ¨å‰ç«¯ (æ–°ç»ˆç«¯)
npm run dev:frontend
```

### 5. éªŒè¯éƒ¨ç½²
```bash
npm run stage4.9:verify
```

## ğŸ§ª æµ‹è¯•é…ç½®

### MetaMask è®¾ç½®
1. æ·»åŠ æœ¬åœ°ç½‘ç»œï¼š
   - ç½‘ç»œåç§°: `Localhost 8545`
   - RPC URL: `http://localhost:8545`
   - é“¾ ID: `31337`
   - è´§å¸ç¬¦å·: `ETH`

2. å¯¼å…¥æµ‹è¯•è´¦æˆ·ï¼š
   - ç§é’¥: `0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80d`
   - åœ°å€: `0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266`

### è®¿é—®åœ°å€
- å‰ç«¯: http://localhost:3000
- åç«¯: http://localhost:3001
- åŒºå—é“¾: http://localhost:8545

## ğŸ® æµ‹è¯•åœºæ™¯

### A. çº¯ ECHO ä»»åŠ¡ (éªŒè¯ç°æœ‰åŠŸèƒ½ä¸å—å½±å“)
1. åˆ›å»º Profile å¹¶æ·»åŠ è”ç³»æ–¹å¼
2. å‘å¸ƒä»»åŠ¡ï¼Œåªè®¾ç½® ECHO å¥–åŠ±
3. ç”¨å¦ä¸€ä¸ªè´¦æˆ·æ¥å—ä»»åŠ¡
4. å®Œæˆä»»åŠ¡æµç¨‹
5. éªŒè¯ ECHO ç»“ç®—æ­£ç¡®

### B. è·¨é“¾å¥–åŠ±ä»»åŠ¡ (æ–°åŠŸèƒ½)
1. å‘å¸ƒä»»åŠ¡æ—¶å¯ç”¨"è·¨é“¾å¥–åŠ±"
2. é€‰æ‹©èµ„äº§ (Mock ZRC20)
3. è®¾ç½®å¥–åŠ±æ•°é‡ (å¦‚ 0.01)
4. é€‰æ‹©ç›®æ ‡é“¾ (Sepolia)
5. å‡†å¤‡å¹¶å­˜å…¥è·¨é“¾å¥–åŠ±
6. å‘å¸ƒä»»åŠ¡
7. Helper å®Œæˆä»»åŠ¡åé¢†å–è·¨é“¾å¥–åŠ±

### C. é”™è¯¯æ¢å¤æµ‹è¯•
1. åˆ›å»ºè·¨é“¾å¥–åŠ±ä½†ä¸å‘å¸ƒä»»åŠ¡ (æµ‹è¯•æ’¤å›)
2. æ¨¡æ‹Ÿè·¨é“¾å¤±è´¥ (æµ‹è¯• onRevert)
3. ä»»åŠ¡å–æ¶ˆåé€€æ¬¾ (æµ‹è¯•é€€æ¬¾æµç¨‹)

## ğŸ“Š éƒ¨ç½²çš„åˆçº¦

### ä¸»è¦åˆçº¦
- **EverEchoUniversalReward**: `0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512`
  - è·¨é“¾å¥–åŠ±ä¸»åˆçº¦
  - çŠ¶æ€æœºç®¡ç†
  - onRevert å›æ»šä¿æŠ¤

- **MockZRC20**: `0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0`
  - æµ‹è¯•ç”¨ ZRC20 ä»£å¸
  - æ”¯æŒ mint å’Œ withdraw

### ç°æœ‰åˆçº¦ (ä¸å˜)
- **TaskEscrow**: ç°æœ‰åœ°å€
- **EOCHOToken**: ç°æœ‰åœ°å€

## ğŸ” éªŒè¯å’Œè°ƒè¯•

### åˆçº¦äº¤äº’
```bash
# è¿›å…¥ Hardhat æ§åˆ¶å°
npx hardhat console --network localhost

# è·å–åˆçº¦å®ä¾‹
const UniversalReward = await ethers.getContractAt("EverEchoUniversalReward", "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512");

# æŸ¥çœ‹å¥–åŠ±è®¡åˆ’
await UniversalReward.getRewardPlan(1);
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# åç«¯æ—¥å¿—
tail -f backend/logs/app.log

# å‰ç«¯å¼€å‘æœåŠ¡å™¨æ—¥å¿—
# æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°
```

### å¸¸è§é—®é¢˜

#### 1. MetaMask è¿æ¥å¤±è´¥
- ç¡®ä¿ç½‘ç»œé…ç½®æ­£ç¡® (Chain ID: 31337)
- é‡ç½® MetaMask è´¦æˆ· (Settings > Advanced > Reset Account)

#### 2. åˆçº¦è°ƒç”¨å¤±è´¥
- æ£€æŸ¥è´¦æˆ·ä½™é¢æ˜¯å¦å……è¶³
- ç¡®è®¤åˆçº¦åœ°å€æ­£ç¡®
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

#### 3. è·¨é“¾å¥–åŠ±ä¸æ˜¾ç¤º
- æ£€æŸ¥å‰ç«¯é…ç½®æ–‡ä»¶ (.env.local)
- ç¡®è®¤åˆçº¦éƒ¨ç½²æˆåŠŸ
- åˆ·æ–°é¡µé¢é‡æ–°è¿æ¥

## ğŸ›‘ åœæ­¢æœåŠ¡

```bash
# Windows
./stop-stage4.9.ps1

# æˆ–æ‰‹åŠ¨åœæ­¢
# Ctrl+C åœæ­¢å„ä¸ªæœåŠ¡
# æˆ–è€…å…³é—­ç›¸åº”çš„ç»ˆç«¯çª—å£
```

## ğŸ“ˆ ç”Ÿäº§éƒ¨ç½²

### Sepolia æµ‹è¯•ç½‘éƒ¨ç½²
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export PRIVATE_KEY="your_private_key"
export SEPOLIA_RPC_URL="https://sepolia.infura.io/v3/your_key"

# éƒ¨ç½²åˆ° Sepolia
DEPLOY_NETWORK=sepolia npm run stage4.9:deploy
```

### ä¸»ç½‘éƒ¨ç½²
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export PRIVATE_KEY="your_private_key"
export MAINNET_RPC_URL="https://mainnet.infura.io/v3/your_key"

# éƒ¨ç½²åˆ°ä¸»ç½‘ (è°¨æ…!)
DEPLOY_NETWORK=mainnet npm run stage4.9:deploy
```

## ğŸ‰ æˆåŠŸæ ‡å¿—

éƒ¨ç½²æˆåŠŸåï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

1. âœ… è®¿é—® http://localhost:3000 çœ‹åˆ°å‰ç«¯ç•Œé¢
2. âœ… è¿æ¥ MetaMask åˆ°æœ¬åœ°ç½‘ç»œ
3. âœ… åˆ›å»º Profile å’Œå‘å¸ƒä»»åŠ¡
4. âœ… åœ¨å‘å¸ƒä»»åŠ¡é¡µé¢çœ‹åˆ°"è·¨é“¾å¥–åŠ±"é€‰é¡¹
5. âœ… æˆåŠŸåˆ›å»ºå¸¦è·¨é“¾å¥–åŠ±çš„ä»»åŠ¡
6. âœ… Helper èƒ½å¤Ÿé¢†å–è·¨é“¾å¥–åŠ±

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
2. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—
3. è¿è¡ŒéªŒè¯è„šæœ¬: `npm run stage4.9:verify`
4. é‡æ–°éƒ¨ç½²: `npm run stage4.9:quick`

---

**å‡†å¤‡å¥½å¼€å§‹æµ‹è¯•äº†å—ï¼Ÿè¿è¡Œ `./start-stage4.9-simple.ps1` å¼€å§‹å§ï¼** ğŸš€