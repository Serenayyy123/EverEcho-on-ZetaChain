# EverEcho 故障排查指南

## 错误：Cannot GET /

### 可能原因 1：访问了 Backend 根路径

**问题**：直接访问 `http://localhost:3000/`

**解决**：
- Backend 是 API 服务，不提供前端页面
- 访问 Frontend：`http://localhost:5173`
- 或访问 Backend API 文档：`http://localhost:3000/` （现已修复）

### 可能原因 2：Frontend 未启动

**问题**：访问 `http://localhost:5173` 显示错误

**解决**：
```bash
cd frontend
npm install
npm run dev
```

### 可能原因 3：Backend 未启动

**问题**：Frontend 无法连接 Backend

**解决**：
```bash
cd backend
npm install
npm run dev
```

---

## 完整启动流程

### 1. 启动 Backend（终端 1）

```bash
cd backend
npm install
npm run dev
```

应该看到：
```
Server running on http://localhost:3000
```

### 2. 启动 Frontend（终端 2）

```bash
cd frontend
npm install
npm run dev
```

应该看到：
```
VITE v5.0.8  ready in XXX ms

➜  Local:   http://localhost:5173/
➜  Network: use --host to expose
```

### 3. 访问应用

打开浏览器访问：`http://localhost:5173`

---

## 常见错误及解决方案

### 错误 1：Cannot GET /

**原因**：访问了错误的端口或路径

**解决**：
- Frontend：`http://localhost:5173`
- Backend API：`http://localhost:3000/api/...`

### 错误 2：Failed to fetch

**原因**：Backend 未启动或端口不匹配

**解决**：
1. 检查 Backend 是否运行在 3000 端口
2. 检查 `frontend/.env` 中的 `VITE_API_URL`

### 错误 3：Module not found

**原因**：依赖未安装

**解决**：
```bash
# Backend
cd backend
npm install

# Frontend
cd frontend
npm install
```

### 错误 4：Port already in use

**原因**：端口被占用

**解决**：
```bash
# 查找占用端口的进程
# Windows
netstat -ano | findstr :3000
taskkill /PID <PID> /F

# Linux/Mac
lsof -i :3000
kill -9 <PID>
```

或修改端口：
```bash
# Backend
PORT=3001 npm run dev

# Frontend - 编辑 vite.config.ts
server: {
  port: 5174,
}
```

### 错误 5：MetaMask not installed

**原因**：浏览器未安装 MetaMask

**解决**：
1. 访问 https://metamask.io
2. 安装 MetaMask 浏览器扩展
3. 创建或导入钱包

### 错误 6：Contract call failed

**原因**：合约地址未配置或网络不匹配

**解决**：
1. 检查 `frontend/.env` 中的合约地址
2. 确保 MetaMask 连接到正确的网络
3. 确保合约已部署

---

## 验证服务状态

### 检查 Backend

```bash
curl http://localhost:3000/
```

应该返回：
```json
{
  "name": "EverEcho Backend API",
  "version": "1.0.0",
  "endpoints": {
    "profile": "/api/profile",
    "task": "/api/task",
    "contacts": "/api/contacts",
    "health": "/health"
  }
}
```

### 检查 Frontend

访问 `http://localhost:5173`，应该看到 EverEcho 首页

---

## 开发环境要求

### 必需软件

- ✅ Node.js >= 18
- ✅ npm >= 9
- ✅ MetaMask 浏览器扩展

### 可选软件

- Hardhat（如需部署合约）
- Git（版本控制）

---

## 快速诊断命令

```bash
# 检查 Node.js 版本
node --version

# 检查 npm 版本
npm --version

# 检查端口占用
# Windows
netstat -ano | findstr :3000
netstat -ano | findstr :5173

# Linux/Mac
lsof -i :3000
lsof -i :5173

# 检查进程
# Windows
tasklist | findstr node

# Linux/Mac
ps aux | grep node
```

---

## 联系支持

如果问题仍未解决，请提供以下信息：

1. 错误截图
2. 浏览器控制台日志（F12 → Console）
3. Backend 终端输出
4. Frontend 终端输出
5. 操作系统和版本
6. Node.js 版本

---

## 相关文档

- `frontend/README.md` - Frontend 使用文档
- `backend/README.md` - Backend 使用文档
- `P0-F1_快速开始.md` - 快速开始指南
- `P0-F1_实现总结.md` - 实现细节
